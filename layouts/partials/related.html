{{/* Related checks: 3 from same hub + 3 from other hubs; only real pages */}}
{{ $all := where .Site.RegularPages "Section" "pages" }}
{{ $all = where $all ".RelPermalink" "ne" .RelPermalink }}

{{ $hub := .Params.hub }}
{{ $same := first 3 (where $all "Params.hub" $hub) }}
{{ $other := first 3 (where $all "Params.hub" "ne" $hub) }}

{{ $related := $same | append $other }}

{{ if gt (len $related) 0 }}
<section class="related">
  <h2 class="related-title">Related checks</h2>
  <div class="cards related-cards">
    {{ range $related }}
      <a class="card" href="{{ .RelPermalink }}">
        <div class="card-title">{{ .Title }}</div>
        {{ with .Params.summary }}<div class="card-summary">{{ . }}</div>{{ end }}
      </a>
    {{ end }}
  </div>
</section>
{{ end }}
