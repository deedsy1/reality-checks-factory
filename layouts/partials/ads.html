{{/* Ads are OFF by default. Uses env vars if permitted; otherwise falls back to hugo.yaml params. */}}

{{ $provider := .Site.Params.ads.provider | default "none" }}
{{ $client := .Site.Params.ads.adsenseClient | default "" }}

{{/* Only try getenv if Hugo allows it (we whitelist in hugo.yaml). */}}
{{ $envProvider := getenv "ADS_PROVIDER" }}
{{ if $envProvider }}{{ $provider = $envProvider }}{{ end }}

{{ $envClient := getenv "ADSENSE_CLIENT" }}
{{ if $envClient }}{{ $client = $envClient }}{{ end }}

{{ if eq $provider "adsense" }}
  {{ if $client }}
    <script async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client={{ $client }}"
      crossorigin="anonymous"></script>

    <ins class="adsbygoogle"
      style="display:block"
      data-ad-client="{{ $client }}"
      data-ad-slot="0000000000"
      data-ad-format="auto"
      data-full-width-responsive="true"></ins>
    <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
  {{ end }}
{{ end }}
